<?xml version="1.0" encoding="UTF-8" ?>

<project name="compile_ta" default="all" basedir=".">  

    <property name="ta.src.dir" value="/home/archermind/jenkins/public/tmp_src/ta" />
    <property name="compile.dir" value="${ta_path}" />
    <property name="compile.ta.dir" value="${compile.dir}/code_files" />

    <property name="dest.dir" value="dest" />
    <property name="ta.dest.dir" value="${dest.dir}/ta" />

    


    <target name="clean" depends="makeclean"  description="removes all generated files">
        <!-- 删除上次生成目录和文件 -->        
        <!-- <delete dir="${src.dir}"/> -->

        <delete verbose="true" includeemptydirs="false">
            <fileset dir="${compile.ta.dir}">
                <include name="**/**"/>
            </fileset>
        </delete>
     
        <delete dir="${dest.dir}"/>
        
        <mkdir dir="${dest.dir}" />
        <mkdir dir="${ta.dest.dir}" />
    </target>


    <target name="makeclean" >
        <echo message="clean the file "/>
        <exec executable="/bin/sh">
            <arg line="-c &quot; cd '${compile.dir}' &amp;&amp; make clean &amp;&amp; ls &quot;"/>

        </exec>
    </target>
   <target name="copy.ta.src" depends="clean" description="copy ta files from svn.ta to compile.ta ">
        <copy todir="${compile.ta.dir}" overwrite="true">
            <fileset dir="${ta.src.dir}">
                <include name="**.c"/>
                <include name="**.h"/>
            </fileset>
        </copy>
    </target>


    <target name="compile.ta" depends="copy.ta.src">
        <exec executable="/bin/sh">
            <arg line="-c &quot; whoami &amp;&amp; cd '${compile.dir}' &amp;&amp; make  &quot;"/>
        </exec>
    </target>


 <target name="copy.ta" depends="compile.ta"  description="copy .ta files to dest.dir">
        <copy todir="${ta.dest.dir}" overwrite="true">
            <fileset dir="${compile.dir}">
                <include name="**.ta"/>
            </fileset>
        </copy>
    </target>

	<target name="all" depends="copy.ta" description="clean, compile, push"/>

</project>

